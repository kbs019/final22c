<!-- <html layout:decorate="~{layout/layout}">
<div layout:fragment="content"> -->
  <!-- 레이아웃 적용시 우편번호 api 작동을 안함 -->
  <h5>배송지 등록</h5>

  <form th:action="@{/mypage}" method="post" th:object="${usersAddressForm}">
    <div>
      <label for="addressName">배송지명</label>
      <input type="text" th:field="*{addressName}" required />
    </div>

    <div>
      <label for="recipient">받는 사람 이름</label>
      <input type="text" th:field="*{recipient}" required />
    </div>

    <div>
      <label for="phone">전화번호</label>
      <input type="text" th:field="*{phone}" required />
    </div>

    <!-- 우편번호 + 버튼 -->
    <div>
      <label for="zonecode">우편번호</label>
      <div style="display: flex; gap: 8px; align-items: center">
        <input type="text" th:field="*{zonecode}" placeholder="우편번호" readonly required />
        <button type="button" onclick="execDaumPostcode()">
          우편번호 찾기
        </button>
      </div>
    </div>

    <div>
      <label for="roadAddress">도로명 주소</label>
      <input type="text" th:field="*{roadAddress}" placeholder="도로명 주소" readonly required />
    </div>

    <div>
      <label for="detailAddress">상세주소</label>
      <input type="text" th:field="*{detailAddress}" placeholder="상세주소" required />
    </div>

    <div>
      <label>
        <input type="checkbox" th:field="*{isDefault}" /> 기본배송지로 설정
      </label>
    </div>

    <button type="submit">등록</button>
    <button type="reset">초기화</button>
  </form>
<!-- </div> -->

  <!-- Daum 우편번호 API -->
  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <script>
    function execDaumPostcode() {
      new daum.Postcode({
        oncomplete: function (data) {
          // 도로명/지번 선택값에 따라 주소 선택
          var addr =
            data.userSelectedType === "R"
              ? data.roadAddress
              : data.jibunAddress;

          // 폼 필드 채우기 (th:field가 만든 id = 필드명)
          document.getElementById("zonecode").value = data.zonecode;
          document.getElementById("roadAddress").value = addr;

          // 상세주소로 포커스
          var detail = document.getElementById("detailAddress");
          if (detail) {
            detail.value = "";
            detail.focus();
          }
        },
      }).open(); // 팝업 방식
    }
  </script>
</html>
