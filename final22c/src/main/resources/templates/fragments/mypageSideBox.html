<style>
  .mp-sidebox__title {
    font-size: 20px;
    font-weight: 800;
    margin: 0 0 12px
  }

  .mp-sidebox__nav {
    display: flex;
    flex-direction: column;
    gap: 6px
  }

  .mp-sidebox__link {
    display: block;
    padding: 8px 10px;
    border-radius: 10px;
    text-decoration: none;
    color: #111827;
    border: 1px solid #e5e7eb;
    background: #fff
  }

  .mp-sidebox__link:hover {
    background: #f3f7ff
  }

  .mp-sidebox__link.is-active {
    background: #111827;
    color: #fff;
    border-color: #111827
  }
</style>
<th:block th:fragment="mypageSidebox(section)">
  <aside class="mp-sidebox" role="navigation" aria-label="마이페이지 메뉴">
    <h2 class="mp-sidebox__title">마이페이지</h2>
    <nav class="mp-sidebox__nav">
      <a th:href="@{/mypage/activity}" class="mp-sidebox__link"
        th:classappend="${section}=='activity' ? ' is-active' : ''"
        th:attr="aria-current=(${section}=='activity') ? 'page' : null">
        활동내역
      </a>

      <a th:href="@{/mypage/address}" class="mp-sidebox__link"
        th:classappend="${section}=='address' ? ' is-active' : ''"
        th:attr="aria-current=(${section}=='address') ? 'page' : null">
        배송지 관리
      </a>

      <!-- 주의: URL은 /mypage/order -->
      <a th:href="@{/mypage/order}" class="mp-sidebox__link" th:classappend="${section}=='orders' ? ' is-active' : ''"
        th:attr="aria-current=(${section}=='orders') ? 'page' : null">
        주문내역
      </a>

      <!-- ✅ 마일리지 내역 추가 -->
      <a th:href="@{/mypage/mileage}" class="mp-sidebox__link"
        th:classappend="${section}=='mileage' ? ' is-active' : ''"
        th:attr="aria-current=(${section}=='mileage') ? 'page' : null">
        <span>마일리지 내역</span>
        <!-- 칩: me.mileage 모델 있을 때만 표시 -->
        <span class="mp-sidebox__chip" th:if="${me != null}"
          th:text="${#numbers.formatInteger(me.mileage?:0,1,'COMMA')} + 'P'">0P</span>
      </a>

      <a th:href="@{/mypage/profile}" class="mp-sidebox__link"
        th:classappend="${section}=='profile' ? ' is-active' : ''"
        th:attr="aria-current=(${section}=='profile') ? 'page' : null">
        개인정보
      </a>

      <a th:href="@{/mypage/wishlist}" class="mp-sidebox__link"
        th:classappend="${section}=='wishlist' ? ' is-active' : ''"
        th:attr="aria-current=(${section}=='wishlist') ? 'page' : null">
        위시리스트
      </a>
    </nav>
  </aside>
</th:block>